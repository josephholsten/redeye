<!DOCTYPE html>  <html> <head>   <title>redeye.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="consts.html">                 consts.coffee               </a>                                           <a class="source" href="db.html">                 db.coffee               </a>                                           <a class="source" href="debug.html">                 debug.coffee               </a>                                           <a class="source" href="dispatcher.html">                 dispatcher.coffee               </a>                                           <a class="source" href="doctor.html">                 doctor.coffee               </a>                                           <a class="source" href="redeye.html">                 redeye.coffee               </a>                                           <a class="source" href="audit_test.html">                 audit_test.coffee               </a>                                           <a class="source" href="cycles_test.html">                 cycles_test.coffee               </a>                                           <a class="source" href="idle_test.html">                 idle_test.coffee               </a>                                           <a class="source" href="loose_ends_test.html">                 loose_ends_test.coffee               </a>                                           <a class="source" href="multi_arg_test.html">                 multi_arg_test.coffee               </a>                                           <a class="source" href="repetition_test.html">                 repetition_test.coffee               </a>                                           <a class="source" href="side_effects_test.html">                 side_effects_test.coffee               </a>                                           <a class="source" href="simple_test.html">                 simple_test.coffee               </a>                                           <a class="source" href="audit_listener.html">                 audit_listener.coffee               </a>                                           <a class="source" href="redeye_suite.html">                 redeye_suite.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               redeye.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h1>Red Eye</h1>

<h2>Fast parallel workers</h2>

<p>Red eye workers handle a single job until completion. The runner defined
by the prefix of the job contains the code to perform the computation.
The runner uses the context of the worker, and has access to three important
methods:</p>

<ul>
<li><code>@get(key)</code>: returns named key from the database</li>
<li><code>@emit(key, value)</code>: stores value for named key to the database</li>
<li><code>@for_reals()</code>: stop and make sure all dependencies have been met</li>
</ul>

<p>The first time a key is requested with <code>@get</code>, the true value of that
key is not returned. Only after calling <code>@for_reals()</code> are those variables
substituted with their actual values. In order to minimize total latency,
you should use as few calls to <code>@for_reals</code> as possible, but remember that
the values returned by <code>@get</code> aren't useful until then.</p>

<p>The runner function is called with the arguments of the job. It can either
use <code>@emit</code> to indicate its result(s), or it can simply return a single
result from the function, but not both.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Dependencies.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">events = </span><span class="nx">require</span> <span class="s1">&#39;events&#39;</span>
<span class="nv">consts = </span><span class="nx">require</span> <span class="s1">&#39;./consts&#39;</span>
<span class="nv">db = </span><span class="nx">require</span> <span class="s1">&#39;./db&#39;</span>
<span class="nv">debug = </span><span class="nx">require</span> <span class="s1">&#39;./debug&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Counts the number of simultaneous workers.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">num_workers = </span><span class="mi">0</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>The <code>WorkQueue</code> accepts job requests and starts <code>Worker</code> objects
to handle them.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">WorkQueue</span> <span class="k">extends</span> <span class="nx">events</span><span class="p">.</span><span class="nx">EventEmitter</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Register the 'next' event, and listen for 'resume' messages.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">constructor: </span><span class="nf">(@options) -&gt;</span>
    <span class="vi">@db = </span><span class="nx">db</span> <span class="nx">@options</span><span class="p">.</span><span class="nx">db_index</span>
    <span class="vi">@resume = </span><span class="nx">db</span> <span class="nx">@options</span><span class="p">.</span><span class="nx">db_index</span>
    <span class="vi">@worker_db = </span><span class="nx">db</span> <span class="nx">@options</span><span class="p">.</span><span class="nx">db_index</span>
    <span class="vi">@workers = </span><span class="p">{}</span>
    <span class="vi">@runners = </span><span class="p">{}</span>
    <span class="nx">@resume</span><span class="p">.</span><span class="kc">on</span> <span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">channel</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="nx">@workers</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">resume</span><span class="p">()</span>
    <span class="nx">@resume</span><span class="p">.</span><span class="nx">subscribe</span> <span class="s2">&quot;resume_#{@options.db_index}&quot;</span>
    <span class="nx">@on</span> <span class="s1">&#39;next&#39;</span><span class="p">,</span> <span class="o">=&gt;</span> <span class="nx">@next</span><span class="p">()</span>
  </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Run the work queue, calling the given callback on completion</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">run: </span><span class="nf">(@callback) -&gt;</span>
    <span class="nx">@next</span><span class="p">()</span>  
    </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Add a worker to the context</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">worker: </span><span class="nf">(prefix, runner) -&gt;</span>
    <span class="nx">@runners</span><span class="p">[</span><span class="nx">prefix</span><span class="p">]</span> <span class="o">=</span> <span class="nx">runner</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Look for the next job using BLPOP on the "jobs" queue. This
will use an event emitter to call <code>next</code> again, so the stack
doesn't get large.</p>

<p>You can push the job <code>!quit</code> to make the work queue die.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">next: </span><span class="o">-&gt;</span>
    <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;blpop &#39;jobs&#39;&quot;</span>
    <span class="nx">@db</span><span class="p">.</span><span class="nx">blpop</span> <span class="s1">&#39;jobs&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">str</span><span class="p">])</span> <span class="o">=&gt;</span>
      <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;queue: job: #{JSON.stringify(str)}&quot;</span>
      <span class="k">throw</span> <span class="nx">err</span> <span class="k">if</span> <span class="nx">err</span>
      <span class="k">return</span> <span class="nx">@quit</span><span class="p">()</span> <span class="k">if</span> <span class="nx">str</span> <span class="o">==</span> <span class="s1">&#39;!quit&#39;</span>
      <span class="nx">@workers</span><span class="p">[</span><span class="nx">str</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Worker</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="k">this</span><span class="p">)</span>
      <span class="nx">@workers</span><span class="p">[</span><span class="nx">str</span><span class="p">].</span><span class="nx">run</span><span class="p">()</span>
      <span class="nx">@emit</span> <span class="s1">&#39;next&#39;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Shut down the redis connection and stop running workers</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">quit: </span><span class="o">-&gt;</span>
    <span class="nx">@db</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
    <span class="nx">@resume</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
    <span class="nx">@worker_db</span><span class="p">.</span><span class="nx">end</span><span class="p">()</span>
    <span class="nx">@callback</span><span class="o">?</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>The worker class is the context under which runner functions are run.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Worker</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Find the runner for the <code>@key</code>. The key is in the format:</p>

<pre><code>prefix:arg1:arg2:...
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">constructor: </span><span class="nf">(@key, @queue) -&gt;</span>
    <span class="p">[</span><span class="nx">@prefix</span><span class="p">,</span> <span class="nx">args</span><span class="p">...]</span> <span class="o">=</span> <span class="nx">@key</span><span class="p">.</span><span class="nx">split</span> <span class="nx">consts</span><span class="p">.</span><span class="nx">arg_sep</span>
    <span class="vi">@args = </span><span class="nx">args</span> <span class="c1"># weird bug in coffeescript: wanted @args... in line above</span>
    <span class="vi">@db = </span><span class="nx">@queue</span><span class="p">.</span><span class="nx">worker_db</span>
    <span class="vi">@req_channel = </span><span class="s2">&quot;requests_#{@queue.options.db_index}&quot;</span>
    <span class="vi">@resp_channel = </span><span class="s2">&quot;responses_#{@queue.options.db_index}&quot;</span>
    <span class="nx">unless</span> <span class="vi">@runner = </span><span class="nx">@queue</span><span class="p">.</span><span class="nx">runners</span><span class="p">[</span><span class="nx">@prefix</span><span class="p">]</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;no runner for &#39;#{@prefix}&#39;&quot;</span><span class="p">)</span>
    <span class="vi">@cache = </span><span class="p">{}</span>
    <span class="vi">@last_stage = </span><span class="mi">0</span>
    <span class="nx">num_workers</span><span class="o">++</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>If we've already seen this <code>@get</code> before, then return the actual
value we've received (which we know we got because otherwise we
wouldn't be running again). Otherwise, just mark this dependency
and return <code>undefined</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">get: </span><span class="nf">(args...) -&gt;</span>
    <span class="nv">key = </span><span class="nx">args</span><span class="p">.</span><span class="nx">join</span> <span class="nx">consts</span><span class="p">.</span><span class="nx">arg_sep</span>
    <span class="k">if</span> <span class="nx">@stage</span> <span class="o">&lt;</span> <span class="nx">@last_stage</span>
      <span class="nx">@cache</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
    <span class="k">else</span>
      <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: add dep: #{key}&quot;</span>
      <span class="nx">@deps</span><span class="p">.</span><span class="nx">push</span> <span class="nx">key</span>
      <span class="kc">undefined</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Produce <code>value</code> as a result for <code>key</code>. This both puts the result
in redis under the key and tells the dispatcher (via the <code>responses</code>
channel) that the job is done.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">emit: </span><span class="nf">(args..., value) -&gt;</span>
    <span class="vi">@emitted = </span><span class="kc">true</span>
    <span class="nv">key = </span><span class="nx">args</span><span class="p">.</span><span class="nx">join</span> <span class="nx">consts</span><span class="p">.</span><span class="nx">arg_sep</span>
    <span class="nx">@db</span><span class="p">.</span><span class="nx">set</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">@db</span><span class="p">.</span><span class="nx">publish</span> <span class="nx">@resp_channel</span><span class="p">,</span> <span class="nx">key</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>If we've seen this <code>@for_reals</code> before, then blow right past it.
Otherwise, abort the runner function and start over (after checking
that our dependencies are met).</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">for_reals: </span><span class="o">-&gt;</span>
    <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: for_reals: stage:&quot;</span><span class="p">,</span> <span class="nx">@stage</span><span class="p">,</span> <span class="s2">&quot;last_stage:&quot;</span><span class="p">,</span> <span class="nx">@last_stage</span>
    <span class="k">if</span> <span class="nx">@stage</span> <span class="o">==</span> <span class="nx">@last_stage</span>
      <span class="k">throw</span> <span class="s1">&#39;resolve&#39;</span>
    <span class="k">else</span>
      <span class="nx">@stage</span><span class="o">++</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Attempt to run the runner function. If a call to <code>@for_reals</code> causes
us to abort, then attempt to resolve the dependencies.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">run: </span><span class="o">-&gt;</span>
    <span class="k">try</span>
      <span class="nx">@clear</span><span class="p">()</span>
      <span class="nx">@process</span><span class="p">()</span>
    <span class="k">catch</span> <span class="nx">err</span>
      <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: run caught: #{err}&quot;</span>
      <span class="nx">@caught</span> <span class="nx">err</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Reset information about this run, including:</p>

<ul>
<li><code>@stage</code>: how many calls to <code>@for_reals</code> we've seen</li>
<li><code>@deps</code>: a list of new dependencies</li>
<li><code>@emitted</code>: whether <code>@emit</code> has been called.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">clear: </span><span class="o">-&gt;</span>
    <span class="vi">@stage = </span><span class="mi">0</span>
    <span class="vi">@deps = </span><span class="p">[]</span>
    <span class="vi">@emitted = </span><span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>If the caught error is from a <code>@for_reals</code>, then try to resolve
dependencies.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">caught: </span><span class="nf">(err) -&gt;</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">==</span> <span class="s1">&#39;resolve&#39;</span>
      <span class="nx">@resolve</span><span class="p">()</span>
    <span class="k">else</span>
      <span class="k">throw</span> <span class="nx">err</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Call the runner. If it gets all the way through, first check if there
were any unmet dependencies after the last <code>@for_reals</code>. If so, we force
one last dependency resolution. Otherwise, we optionally
emit the result of the function (if nothing has been emitted yet).</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">process: </span><span class="o">-&gt;</span>
    <span class="nv">result = </span><span class="nx">@runner</span><span class="p">.</span><span class="nx">apply</span> <span class="k">this</span><span class="p">,</span> <span class="nx">@args</span>
    <span class="k">return</span> <span class="nx">@resolve</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@deps</span><span class="p">.</span><span class="nx">length</span>
    <span class="nx">num_workers</span><span class="o">--</span>
    <span class="k">if</span> <span class="nx">result</span><span class="o">?</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">@emitted</span>
      <span class="nx">@emit</span> <span class="nx">@key</span><span class="p">,</span> <span class="nx">result</span>
    <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: done:&quot;</span><span class="p">,</span> <span class="nx">@key</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Compare the provided values against our current dependencies.
Missing dependencies are returned in an array.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">check_values: </span><span class="nf">(arr) -&gt;</span>
    <span class="nv">bad = </span><span class="p">[]</span>
    <span class="k">for</span> <span class="nx">dep</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">@deps</span>
      <span class="nx">@cache</span><span class="p">[</span><span class="nx">dep</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
      <span class="nx">bad</span><span class="p">.</span><span class="nx">push</span> <span class="nx">dep</span> <span class="nx">unless</span> <span class="nx">@cache</span><span class="p">[</span><span class="nx">dep</span><span class="p">]</span><span class="o">?</span>
    <span class="nx">bad</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>The first step in resolving dependencies from a <code>@for_reals</code> is
to record that there's one more of them to get through, then to check
the dependencies.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">resolve: </span><span class="o">-&gt;</span>
    <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: resolve&quot;</span>
    <span class="nx">@last_stage</span><span class="o">++</span>
    <span class="nx">@get_deps</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Ask redis to provide values for our dependencies. If any are missing,
send a request to the dispatcher; otherwise, resume trying to run the
main function.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">get_deps: </span><span class="o">-&gt;</span>
    <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: get_deps:&quot;</span><span class="p">,</span> <span class="nx">@deps</span>
    <span class="nx">@db</span><span class="p">.</span><span class="nx">mget</span> <span class="nx">@deps</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">arr</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="k">throw</span> <span class="nx">err</span> <span class="k">if</span> <span class="nx">err</span>
      <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: mget:&quot;</span><span class="p">,</span> <span class="nx">arr</span>
      <span class="nv">bad = </span><span class="nx">@check_values</span> <span class="nx">arr</span>
      <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: bad:&quot;</span><span class="p">,</span> <span class="nx">bad</span>
      <span class="k">if</span> <span class="nx">bad</span><span class="p">.</span><span class="nx">length</span>
        <span class="nx">@request_missing</span> <span class="nx">bad</span>
      <span class="k">else</span>
        <span class="nx">@run</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Ask the dispatcher to providethe given keys by publishing on the
<code>requests</code> channel. Then block-wait to be signalled by a response
on a resume key. Once we get that response, try again to fetch the
dependencies (which should all be present).</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">request_missing: </span><span class="nf">(keys) -&gt;</span>
    <span class="nv">request = </span><span class="p">[</span><span class="nx">@key</span><span class="p">,</span> <span class="nx">keys</span><span class="p">...].</span><span class="nx">join</span> <span class="nx">consts</span><span class="p">.</span><span class="nx">key_sep</span>
    <span class="nx">debug</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;worker: requesting: #{request}&quot;</span>
    <span class="nx">@db</span><span class="p">.</span><span class="nx">publish</span> <span class="nx">@req_channel</span><span class="p">,</span> <span class="nx">request</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>The dispatcher said to resume, so go look for the missing values again.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">resume: </span><span class="o">-&gt;</span>
    <span class="nx">@get_deps</span><span class="p">()</span>


<span class="nv">module.exports =</span>
  </pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Create and return a new work queue with the given options.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">queue: </span><span class="nf">(options) -&gt;</span> <span class="k">new</span> <span class="nx">WorkQueue</span><span class="p">(</span><span class="nx">options</span> <span class="o">?</span> <span class="p">{})</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 